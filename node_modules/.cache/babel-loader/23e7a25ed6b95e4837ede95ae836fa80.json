{"ast":null,"code":"var _classCallCheck = require(\"/Users/jgarc609/github/changing-complex-state-completed-forked/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"/Users/jgarc609/github/changing-complex-state-completed-forked/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createClass\");\n\nvar _get = require(\"/Users/jgarc609/github/changing-complex-state-completed-forked/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/get\");\n\nvar _getPrototypeOf = require(\"/Users/jgarc609/github/changing-complex-state-completed-forked/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/getPrototypeOf\");\n\nvar _inherits = require(\"/Users/jgarc609/github/changing-complex-state-completed-forked/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/inherits\");\n\nvar _createSuper = require(\"/Users/jgarc609/github/changing-complex-state-completed-forked/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createSuper\");\n\nvar binding = require('bindings')('bindings.node');\n\nvar AbstractBinding = require('@serialport/binding-abstract');\n\nvar promisify = require('./util').promisify;\n\nvar serialNumParser = require('./win32-sn-parser');\n/**\n * The Windows binding layer\n */\n\n\nvar WindowsBinding = /*#__PURE__*/function (_AbstractBinding) {\n  \"use strict\";\n\n  _inherits(WindowsBinding, _AbstractBinding);\n\n  var _super = _createSuper(WindowsBinding);\n\n  function WindowsBinding(opt) {\n    var _this;\n\n    _classCallCheck(this, WindowsBinding);\n\n    _this = _super.call(this, opt);\n    _this.bindingOptions = Object.assign({}, opt.bindingOptions || {});\n    _this.fd = null;\n    _this.writeOperation = null;\n    return _this;\n  }\n\n  _createClass(WindowsBinding, [{\n    key: \"isOpen\",\n    get: function get() {\n      return this.fd !== null;\n    }\n  }, {\n    key: \"open\",\n    value: function open(path, options) {\n      var _this2 = this;\n\n      return _get(_getPrototypeOf(WindowsBinding.prototype), \"open\", this).call(this, path, options).then(function () {\n        _this2.openOptions = Object.assign({}, _this2.bindingOptions, options);\n        return promisify(binding.open)(path, _this2.openOptions);\n      }).then(function (fd) {\n        _this2.fd = fd;\n      });\n    }\n  }, {\n    key: \"close\",\n    value: function close() {\n      var _this3 = this;\n\n      return _get(_getPrototypeOf(WindowsBinding.prototype), \"close\", this).call(this).then(function () {\n        var fd = _this3.fd;\n        _this3.fd = null;\n        return promisify(binding.close)(fd);\n      });\n    }\n  }, {\n    key: \"read\",\n    value: function read(buffer, offset, length) {\n      var _this4 = this;\n\n      return _get(_getPrototypeOf(WindowsBinding.prototype), \"read\", this).call(this, buffer, offset, length).then(function () {\n        return promisify(binding.read)(_this4.fd, buffer, offset, length);\n      }).catch(function (err) {\n        if (!_this4.isOpen) {\n          err.canceled = true;\n        }\n\n        throw err;\n      });\n    }\n  }, {\n    key: \"write\",\n    value: function write(buffer) {\n      var _this5 = this;\n\n      if (buffer.length > 0) {\n        this.writeOperation = _get(_getPrototypeOf(WindowsBinding.prototype), \"write\", this).call(this, buffer).then(function () {\n          return promisify(binding.write)(_this5.fd, buffer);\n        }).then(function () {\n          _this5.writeOperation = null;\n        });\n        return this.writeOperation;\n      }\n\n      return Promise.resolve();\n    }\n  }, {\n    key: \"update\",\n    value: function update(options) {\n      var _this6 = this;\n\n      return _get(_getPrototypeOf(WindowsBinding.prototype), \"update\", this).call(this, options).then(function () {\n        return promisify(binding.update)(_this6.fd, options);\n      });\n    }\n  }, {\n    key: \"set\",\n    value: function set(options) {\n      var _this7 = this;\n\n      return _get(_getPrototypeOf(WindowsBinding.prototype), \"set\", this).call(this, options).then(function () {\n        return promisify(binding.set)(_this7.fd, options);\n      });\n    }\n  }, {\n    key: \"get\",\n    value: function get() {\n      var _this8 = this;\n\n      return _get(_getPrototypeOf(WindowsBinding.prototype), \"get\", this).call(this).then(function () {\n        return promisify(binding.get)(_this8.fd);\n      });\n    }\n  }, {\n    key: \"getBaudRate\",\n    value: function getBaudRate() {\n      var _this9 = this;\n\n      return _get(_getPrototypeOf(WindowsBinding.prototype), \"get\", this).call(this).then(function () {\n        return promisify(binding.getBaudRate)(_this9.fd);\n      });\n    }\n  }, {\n    key: \"drain\",\n    value: function drain() {\n      var _this10 = this;\n\n      return _get(_getPrototypeOf(WindowsBinding.prototype), \"drain\", this).call(this).then(function () {\n        return Promise.resolve(_this10.writeOperation);\n      }).then(function () {\n        return promisify(binding.drain)(_this10.fd);\n      });\n    }\n  }, {\n    key: \"flush\",\n    value: function flush() {\n      var _this11 = this;\n\n      return _get(_getPrototypeOf(WindowsBinding.prototype), \"flush\", this).call(this).then(function () {\n        return promisify(binding.flush)(_this11.fd);\n      });\n    }\n  }], [{\n    key: \"list\",\n    value: function list() {\n      return promisify(binding.list)().then(function (ports) {\n        // Grab the serial number from the pnp id\n        ports.forEach(function (port) {\n          if (port.pnpId && !port.serialNumber) {\n            var serialNumber = serialNumParser(port.pnpId);\n\n            if (serialNumber) {\n              port.serialNumber = serialNumber;\n            }\n          }\n        });\n        return ports;\n      });\n    }\n  }]);\n\n  return WindowsBinding;\n}(AbstractBinding);\n\nmodule.exports = WindowsBinding;","map":null,"metadata":{},"sourceType":"script"}